---
title: ccjk update
---

# ccjk update

`ccjk update`（省略形 `ccjk u`）は、ワークフローテンプレート、プロンプト、ツールバージョンの確認を更新するために使用されます。これは軽量な更新コマンドで、API 設定やインストール済みの MCP サービスを変更しません。

## 機能概要

`ccjk update` コマンドは以下の操作を実行します：

1. 📝 **プロンプトを更新**：最新のワークフローテンプレートとプロンプト内容を同期
2. 🔄 **ワークフローを更新**：ワークフローテンプレートを更新またはインストール
3. 📊 **バージョンを確認**：Claude Code または Codex のバージョンを確認し、更新を促す（利用可能な場合）
4. 🌐 **言語を同期**：テンプレート言語と AI 出力言語を更新
5. 💾 **バックアップを作成**：更新前に自動的にバックアップを作成

## 基本的な使用方法

### 対話式モード（推奨）

```bash
# 保存された設定を使用して更新
npx ccjk update

# または省略形を使用
npx ccjk u

# またはメインメニューから
npx ccjk
# 次に 2 (ワークフローをインポート) を選択
```

対話式モードでは、CCJK は：

1. テンプレート言語を尋ねる（設定が保存されていない場合）
2. AI 出力言語を尋ねる（設定が保存されていない場合）
3. 更新/インストールするワークフローを選択
4. ツールバージョンを確認して更新を促す

### 非対話式モード

```bash
# デフォルト言語設定を使用して更新
npx ccjk u -s

# テンプレート言語を指定
npx ccjk u -s -c zh-CN

# AI 出力言語を指定
npx ccjk u -s -a zh-CN

# テンプレートと出力言語を同時に指定
npx ccjk u -s -g zh-CN

# コードツールタイプを指定
npx ccjk u -s -T codex
```

## よく使うパラメータ

| パラメータ | 省略形 | 説明 | オプション値 | デフォルト値 |
|------|------|------|--------|--------|
| `--skip-prompt, -s` | `-s` | すべての対話プロンプトをスキップ | - | - |
| `--config-lang, -c` | `-c` | テンプレートファイル言語 | `zh-CN`, `en` | ユーザー保存設定または `en` |
| `--ai-output-lang, -a` | `-a` | AI 出力言語 | `zh-CN`, `en`, カスタム文字列 | ユーザー保存設定または `en` |
| `--all-lang, -g` | `-g` | すべての言語パラメータを統一設定 | `zh-CN`, `en`, カスタム文字列 | - |
| `--code-type, -T` | `-T` | 対象コードツールタイプ | `claude-code`, `codex`, `cc`, `cx` | CCJK 設定の現在のツールタイプ |

> 💡 **ヒント**：`--all-lang` を使用すると、テンプレート言語と AI 出力言語を一度に設定できます。

## 使用シナリオ

### シナリオ 1：定期的なワークフロー更新

```bash
# 最新のワークフローテンプレートを取得するために定期的に実行
npx ccjk u

# 週に1回更新（推奨）
# cron タスクまたは CI/CD プロセスに追加できます
```

### シナリオ 2：特定のコードツールを更新

```bash
# Claude Code ワークフローを更新
npx ccjk u -T claude-code -c zh-CN

# Codex ワークフローを更新
npx ccjk u -T codex -c zh-CN
```

### シナリオ 3：言語設定を同期

```bash
# すべての言語設定を中国語に切替
npx ccjk u -g zh-CN

# テンプレートは中国語、AI 出力は英語
npx ccjk u -c zh-CN -a en
```

### シナリオ 4：自動化更新

```bash
# 非対話式更新（スクリプトに適している）
npx ccjk u -s -g zh-CN -T claude-code
```

## 実行フロー

`ccjk update` の実行フローは以下のとおりです：

### Claude Code フロー

1. **Banner を表示**：更新プロンプトを表示
2. **言語設定を解析**：パラメータ、設定、または対話から言語設定を取得
3. **プロンプトを更新**：最新のワークフローテンプレートとプロンプトを同期
4. **ワークフローを選択**：インストール/更新するワークフローを対話式で選択
5. **バージョンを確認**：Claude Code バージョンを確認して更新を促す
6. **設定を保存**：CCJK グローバル設定を更新

### Codex フロー

1. **Banner を表示**：更新プロンプトを表示
2. **Codex 更新を実行**：Codex 固有の更新フローを実行
3. **ワークフローを更新**：Codex ワークフローテンプレートを更新
4. **設定を保存**：CCJK グローバル設定を更新

## 更新内容

`ccjk update` は以下の内容を更新します：

### ワークフローテンプレート

- ✅ 6段階ワークフロー（`/ccjk:workflow`）
- ✅ 機能開発ワークフロー（`/ccjk:feat`）
- ✅ Git ワークフロー（`/git-commit` など）
- ✅ BMad ワークフロー（`/bmad-init`）
- ✅ 共通ツール（`/init-project`）

> ⚠️ **注意**：Codex は現在 6段階ワークフローと Git ワークフローのみをサポートしています。

### プロンプト内容

- ✅ システムプロンプト（`CLAUDE.md`）
- ✅ ワークフローコマンドテンプレート
- ✅ AI エージェントテンプレート
- ✅ 出力スタイルテンプレート

### 更新されない内容

`ccjk update` は以下の内容を**変更しません**：

- ❌ API 設定（キー、認証方式など）
- ❌ MCP サービス設定（インストール済みサービス）
- ❌ カスタム出力スタイル
- ❌ プロジェクト固有の設定

これらの内容を更新する必要がある場合は、`ccjk init` または対応する設定メニューを使用してください。

## バージョン確認

`ccjk update` は自動的にツールバージョンを確認します：

### Claude Code バージョン確認

- 現在インストールされている Claude Code バージョンを確認
- 新しいバージョンが利用可能な場合、ユーザーに更新を促す
- 更新プロンプトは対話モードでのみ表示

### Codex バージョン確認

- Codex 更新フローで自動実行
- Codex CLI バージョンを確認して更新（必要に応じて）

## バックアップメカニズム

ワークフローとプロンプトを更新する前に、CCJK は自動的にバックアップを作成します：

### Claude Code バックアップ

- バックアップ場所：`~/.claude/backup/`
- バックアップ内容：ワークフローテンプレート、プロンプト、設定ファイル
- バックアップ形式：タイムスタンプディレクトリ（例：`backup_2025-01-15_10-30-45/`）

### Codex バックアップ

- バックアップ場所：`~/.codex/backup/`
- バックアップ内容：ワークフローテンプレート、設定ファイル
- バックアップ形式：タイムスタンプディレクトリ

## ベストプラクティス

### 1. 定期的な更新

最新のワークフローと改善を取得するために、定期的に `ccjk update` を実行することをお勧めします：

```bash
# 週に1回更新
npx ccjk u -g zh-CN

# または cron タスクに追加
0 0 * * 0 /usr/local/bin/npx ccjk u -s -g zh-CN
```

### 2. 更新前の確認

更新前に現在の設定を確認できます：

```bash
# 現在のワークフローを確認
ls -la ~/.claude/workflows/

# バックアップを確認
ls -la ~/.claude/backup/
```

### 3. カスタム内容を保持

カスタムワークフローまたはプロンプトがある場合：

1. **カスタム内容をバックアップ**：更新前に手動でバックアップ
2. **`docs-only` モードを使用**：`ccjk init` で `--config-action docs-only` を使用
3. **差分を確認**：更新後、バックアップと現在のファイルを比較

### 4. チーム同期

チーム環境では：

- 更新頻度と言語設定を統一
- 更新されたワークフローテンプレートを共有
- Git を使用してカスタムテンプレートを管理

```bash
# チーム統一の更新コマンド
npx ccjk u -s -g zh-CN -T claude-code
```

## トラブルシューティング

### 更新の失敗

更新が失敗した場合：

1. **ネットワーク接続を確認**：npm registry にアクセスできることを確認
2. **権限を確認**：設定ディレクトリに書き込み権限があることを確認
3. **エラー情報を確認**：ターミナル出力のエラー情報を確認

```bash
# 権限を確認
ls -la ~/.claude/ ~/.codex/

# 必要に応じてバックアップディレクトリを手動で作成
mkdir -p ~/.claude/backup ~/.codex/backup
```

### ワークフローが更新されない

ワークフローが更新されない場合：

```bash
# ワークフローを強制的に再インストール
npx ccjk init --config-action new -w all

# または手動でワークフローディレクトリを確認
ls -la ~/.claude/workflows/
```

### バージョン確認が動作しない

バージョン確認がプロンプトを表示しない場合：

1. **Claude Code がインストールされていることを確認**：`claude-code` コマンドが利用可能か確認
2. **手動でバージョンを確認**：`claude-code --version` を使用
3. **check-updates コマンドを使用**：`npx ccjk check-updates` を実行

## init との違い

| 特性 | `ccjk init` | `ccjk update` |
|------|-----------|-------------|
| **主な用途** | 環境を完全に初期化 | ワークフローとテンプレートを更新 |
| **API 設定** | ✅ 設定する | ❌ 変更しない |
| **MCP サービス** | ✅ インストールして設定する | ❌ 変更しない |
| **ワークフロー** | ✅ インストールする | ✅ 更新する |
| **出力スタイル** | ✅ 設定する | ❌ 変更しない |
| **バージョン確認** | ❌ 確認しない | ✅ 確認する |
| **バックアップ** | ✅ バックアップを作成 | ✅ バックアップを作成 |

> 💡 **推奨事項**：
> - 初回使用時、または API/MCP 設定を変更する必要がある場合、`ccjk init` を使用
> - ワークフローとテンプレートのみを更新する必要がある場合、`ccjk update` を使用

## 関連リソース

- [ccjk init](init.md) - 完全初期化コマンド
- [ワークフローシステム](../features/workflows.md) - ワークフローの詳細な紹介
- [設定管理](../features/multi-config.md) - バックアップと復元
- [check-updates](check-updates.md) - バージョン確認コマンド

> 💡 **ヒント**：特に新機能がリリースされたり、テンプレートが更新されたりした場合、ワークフローテンプレートとプロンプトを最新の状態に保つために、定期的に `ccjk update` を実行することをお勧めします。
