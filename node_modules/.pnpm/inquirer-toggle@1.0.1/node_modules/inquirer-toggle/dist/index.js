"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const core_1 = require("@inquirer/core");
const core_2 = require("@inquirer/core");
const ansi_escapes_1 = __importDefault(require("ansi-escapes"));
function isLeftKey(key) {
    return key.name === "left";
}
function isRightKey(key) {
    return key.name === "right";
}
exports.default = (0, core_2.createPrompt)((config, done) => {
    var _a;
    const theme = (0, core_2.makeTheme)({ active: "yes", inactive: "no" }, config.theme);
    const prefix = (0, core_2.usePrefix)({ theme });
    const [value, setValue] = (0, core_1.useState)((_a = config.default) !== null && _a !== void 0 ? _a : false);
    const [isDone, setIsDone] = (0, core_1.useState)(false);
    (0, core_1.useKeypress)((key) => {
        if ((0, core_1.isEnterKey)(key)) {
            setIsDone(true);
            done(value);
        }
        else if (isLeftKey(key) || isRightKey(key) || (0, core_1.isUpKey)(key) || (0, core_1.isDownKey)(key)) {
            setValue(!value);
        }
    });
    const message = theme.style.message(config.message);
    if (isDone) {
        return `${prefix} ${message} ${theme.style.answer(value ? theme.active : theme.inactive)}`;
    }
    const activeMessage = value ? theme.style.highlight(theme.active) : theme.active;
    const inactiveMessage = value ? theme.inactive : theme.style.highlight(theme.inactive);
    return `${prefix} ${message} ${inactiveMessage} / ${activeMessage}${ansi_escapes_1.default.cursorHide}`;
});
