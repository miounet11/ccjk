# Postmortem Intelligence System

## ğŸ¯ æ ¸å¿ƒç†å¿µ

Postmortem ç³»ç»Ÿä¸æ™ºèƒ½ä¸Šä¸‹æ–‡æ·±åº¦èåˆï¼Œå½¢æˆ**å­¦ä¹ å‹å¼€å‘é—­ç¯**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¼€å‘ç”Ÿå‘½å‘¨æœŸé—­ç¯                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚  å¼€å‘    â”‚â”€â”€â”€â–¶â”‚  æäº¤    â”‚â”€â”€â”€â–¶â”‚  å‘å¸ƒ    â”‚â”€â”€â”€â–¶â”‚  åˆ†æ    â”‚ â”‚
â”‚   â”‚ Develop  â”‚    â”‚  Commit  â”‚    â”‚ Release  â”‚    â”‚ Analyze  â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â–²                                               â”‚        â”‚
â”‚        â”‚                                               â–¼        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  é¢„é˜²    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Postmortemâ”‚  â”‚
â”‚   â”‚ Prevent  â”‚         å­¦ä¹ åé¦ˆ                  â”‚  Report   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ ä¸æ™ºèƒ½ä¸Šä¸‹æ–‡çš„èåˆ

### 1. ä¸Šä¸‹æ–‡æ³¨å…¥å±‚çº§

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CLAUDE.md ä¸Šä¸‹æ–‡å±‚çº§                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Level 1: å…¨å±€è§„åˆ™ (~/.claude/CLAUDE.md)                        â”‚
â”‚  â”œâ”€â”€ é€šç”¨ç¼–ç è§„èŒƒ                                                â”‚
â”‚  â””â”€â”€ è·¨é¡¹ç›® Postmortem æ•™è®­                                      â”‚
â”‚                                                                 â”‚
â”‚  Level 2: é¡¹ç›®è§„åˆ™ (./CLAUDE.md)                                 â”‚
â”‚  â”œâ”€â”€ é¡¹ç›®ç‰¹å®šè§„èŒƒ                                                â”‚
â”‚  â”œâ”€â”€ é¡¹ç›® Postmortem æ‘˜è¦ â—€â”€â”€ è‡ªåŠ¨æ³¨å…¥                          â”‚
â”‚  â””â”€â”€ é«˜é¢‘é—®é¢˜é¢„è­¦                                                â”‚
â”‚                                                                 â”‚
â”‚  Level 3: æœ¬åœ°è§„åˆ™ (./.claude/CLAUDE.md)                        â”‚
â”‚  â”œâ”€â”€ ä¸ªäººåå¥½                                                   â”‚
â”‚  â””â”€â”€ ä¸´æ—¶è§„åˆ™                                                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Postmortem æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Postmortem æ•°æ®æµ                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Git History â”€â”€â–¶ Fix Commits â”€â”€â–¶ AI Analysis â”€â”€â–¶ Postmortem    â”‚
â”‚       â”‚              â”‚               â”‚              â”‚           â”‚
â”‚       â”‚              â”‚               â”‚              â–¼           â”‚
â”‚       â”‚              â”‚               â”‚         ./postmortem/    â”‚
â”‚       â”‚              â”‚               â”‚              â”‚           â”‚
â”‚       â”‚              â”‚               â”‚              â–¼           â”‚
â”‚       â”‚              â”‚               â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚       â”‚              â”‚               â”‚      â”‚ PM-001.md    â”‚    â”‚
â”‚       â”‚              â”‚               â”‚      â”‚ PM-002.md    â”‚    â”‚
â”‚       â”‚              â”‚               â”‚      â”‚ ...          â”‚    â”‚
â”‚       â”‚              â”‚               â”‚      â”‚ index.json   â”‚    â”‚
â”‚       â”‚              â”‚               â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚       â”‚              â”‚               â”‚              â”‚           â”‚
â”‚       â”‚              â”‚               â”‚              â–¼           â”‚
â”‚       â”‚              â”‚               â”‚      CLAUDE.md æ³¨å…¥      â”‚
â”‚       â”‚              â”‚               â”‚              â”‚           â”‚
â”‚       â”‚              â”‚               â”‚              â–¼           â”‚
â”‚       â”‚              â”‚               â”‚      AI å¼€å‘æ—¶å‚è€ƒ       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ ç›®å½•ç»“æ„

```
./postmortem/
â”œâ”€â”€ index.json              # ç´¢å¼•æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰ PM çš„å…ƒæ•°æ®
â”œâ”€â”€ PM-001-null-check.md    # å…·ä½“çš„ Postmortem æŠ¥å‘Š
â”œâ”€â”€ PM-002-async-error.md
â”œâ”€â”€ PM-003-type-safety.md
â”œâ”€â”€ ...
â”œâ”€â”€ categories/
â”‚   â”œâ”€â”€ type-safety.json    # æŒ‰ç±»åˆ«ç´¢å¼•
â”‚   â”œâ”€â”€ error-handling.json
â”‚   â””â”€â”€ performance.json
â””â”€â”€ summaries/
    â”œâ”€â”€ v2.2.0.md           # ç‰ˆæœ¬å‘å¸ƒæ‘˜è¦
    â””â”€â”€ v2.3.0.md
```

## ğŸ”§ å‘½ä»¤è®¾è®¡

### 1. åˆå§‹åŒ– Postmortem ç³»ç»Ÿ
```bash
ccjk postmortem init
# åˆ†æå†å² fix commitsï¼Œç”Ÿæˆåˆå§‹ postmortem æŠ¥å‘Š
```

### 2. ç”Ÿæˆæ–°çš„ Postmortem
```bash
ccjk postmortem generate [--since <tag>] [--until <tag>]
# åˆ†ææŒ‡å®šèŒƒå›´çš„ fix commits
```

### 3. æ£€æŸ¥æ½œåœ¨é—®é¢˜
```bash
ccjk postmortem check [--staged] [--branch <name>]
# æ£€æŸ¥å½“å‰ä»£ç æ˜¯å¦å¯èƒ½è§¦å‘å·²çŸ¥é—®é¢˜
```

### 4. æŸ¥çœ‹ Postmortem
```bash
ccjk postmortem list
ccjk postmortem show <id>
```

### 5. åŒæ­¥åˆ° CLAUDE.md
```bash
ccjk postmortem sync
# å°†é«˜ä¼˜å…ˆçº§ postmortem åŒæ­¥åˆ° CLAUDE.md
```

## ğŸ“‹ Postmortem æŠ¥å‘Šæ ¼å¼

```markdown
# PM-001: ç©ºå€¼æ£€æŸ¥ç¼ºå¤±å¯¼è‡´è¿è¡Œæ—¶é”™è¯¯

## å…ƒæ•°æ®
- **ID**: PM-001
- **ä¸¥é‡ç¨‹åº¦**: High
- **ç±»åˆ«**: Type Safety
- **åˆ›å»ºæ—¶é—´**: 2024-01-15
- **ç›¸å…³æäº¤**: abc1234, def5678
- **å½±å“ç‰ˆæœ¬**: v2.1.0 - v2.1.3

## é—®é¢˜æè¿°
åœ¨å¤„ç† API å“åº”æ—¶ï¼Œæœªå¯¹å¯èƒ½ä¸º null çš„å­—æ®µè¿›è¡Œæ£€æŸ¥ï¼Œ
å¯¼è‡´åœ¨ç‰¹å®šæ¡ä»¶ä¸‹å‡ºç° "Cannot read property 'x' of null" é”™è¯¯ã€‚

## æ ¹æœ¬åŸå› 
1. TypeScript çš„ strict null checks æœªå¯ç”¨
2. API å“åº”ç±»å‹å®šä¹‰ä¸å‡†ç¡®
3. ç¼ºå°‘é˜²å¾¡æ€§ç¼–ç¨‹æ„è¯†

## ä¿®å¤æ–¹æ¡ˆ
```typescript
// âŒ é”™è¯¯å†™æ³•
const value = response.data.field.value;

// âœ… æ­£ç¡®å†™æ³•
const value = response.data?.field?.value ?? defaultValue;
```

## é¢„é˜²æªæ–½
1. å¯ç”¨ TypeScript strict æ¨¡å¼
2. ä½¿ç”¨ optional chaining (?.) å’Œ nullish coalescing (??)
3. ä¸ºæ‰€æœ‰å¤–éƒ¨æ•°æ®æ·»åŠ è¿è¡Œæ—¶éªŒè¯

## AI å¼€å‘æŒ‡ä»¤
å½“å¤„ç†ä»¥ä¸‹åœºæ™¯æ—¶ï¼Œå¿…é¡»è¿›è¡Œç©ºå€¼æ£€æŸ¥ï¼š
- API å“åº”æ•°æ®
- ç”¨æˆ·è¾“å…¥
- é…ç½®æ–‡ä»¶è¯»å–
- æ•°æ®åº“æŸ¥è¯¢ç»“æœ

## æ£€æµ‹æ¨¡å¼
```regex
# å¯èƒ½è§¦å‘æ­¤é—®é¢˜çš„ä»£ç æ¨¡å¼
\.\w+\.\w+\.\w+(?!\?)  # è¿ç»­å±æ€§è®¿é—®æœªä½¿ç”¨å¯é€‰é“¾
```

## ç›¸å…³æ–‡ä»¶
- src/utils/api-client.ts
- src/services/data-fetcher.ts
```

## ğŸ¤– GitHub Workflow é›†æˆ

### Pre-Release æ£€æŸ¥
```yaml
# .github/workflows/pre-release-check.yml
name: Pre-Release Postmortem Check

on:
  pull_request:
    branches: [main, release/*]

jobs:
  postmortem-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Run Postmortem Check
        run: npx ccjk postmortem check --staged
```

### Post-Release åˆ†æ
```yaml
# .github/workflows/post-release-analysis.yml
name: Post-Release Postmortem Analysis

on:
  release:
    types: [published]

jobs:
  generate-postmortem:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Generate Postmortem
        run: npx ccjk postmortem generate --since ${{ github.event.release.tag_name }}
      - name: Commit Postmortem
        run: |
          git config user.name "github-actions[bot]"
          git add ./postmortem/
          git commit -m "docs: add postmortem for ${{ github.event.release.tag_name }}"
          git push
```

## ğŸ§  æ™ºèƒ½ä¸Šä¸‹æ–‡èåˆæœºåˆ¶

### 1. è‡ªåŠ¨æ³¨å…¥åˆ° CLAUDE.md

ç³»ç»Ÿä¼šè‡ªåŠ¨å°†é«˜ä¼˜å…ˆçº§çš„ Postmortem æ‘˜è¦æ³¨å…¥åˆ°é¡¹ç›®çš„ CLAUDE.md ä¸­ï¼š

```markdown
## âš ï¸ å·²çŸ¥é—®é¢˜é¢„è­¦ (Auto-generated from Postmortem)

åŸºäºå†å² bug åˆ†æï¼Œåœ¨ä»¥ä¸‹åœºæ™¯éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š

### é«˜ä¼˜å…ˆçº§
- **PM-001**: å¤„ç† API å“åº”æ—¶å¿…é¡»è¿›è¡Œç©ºå€¼æ£€æŸ¥
- **PM-003**: å¼‚æ­¥æ“ä½œå¿…é¡»æœ‰é”™è¯¯å¤„ç†

### ä¸­ä¼˜å…ˆçº§
- **PM-002**: é¿å…åœ¨å¾ªç¯ä¸­è¿›è¡ŒåŒæ­¥ I/O æ“ä½œ

è¯¦ç»†ä¿¡æ¯è¯·æŸ¥çœ‹ ./postmortem/ ç›®å½•
```

### 2. å¼€å‘æ—¶å®æ—¶æé†’

å½“ AI æ£€æµ‹åˆ°ä»£ç æ¨¡å¼å¯èƒ½è§¦å‘å·²çŸ¥ Postmortem æ—¶ï¼Œä¼šä¸»åŠ¨æé†’ï¼š

```
âš ï¸ æ£€æµ‹åˆ°å¯èƒ½è§¦å‘ PM-001 çš„ä»£ç æ¨¡å¼
å»ºè®®ï¼šä½¿ç”¨å¯é€‰é“¾æ“ä½œç¬¦ (?.) è¿›è¡Œç©ºå€¼æ£€æŸ¥
å‚è€ƒï¼š./postmortem/PM-001-null-check.md
```

### 3. ä¼šè¯æ‘˜è¦å…³è”

æ™ºèƒ½ä¸Šä¸‹æ–‡ç³»ç»Ÿåœ¨ç”Ÿæˆä¼šè¯æ‘˜è¦æ—¶ï¼Œä¼šè‡ªåŠ¨å…³è”ç›¸å…³çš„ Postmortemï¼š

```json
{
  "summary": "...",
  "relatedPostmortems": ["PM-001", "PM-003"],
  "newIssuesDetected": [
    {
      "pattern": "æœªå¤„ç†çš„ Promise rejection",
      "suggestPostmortem": true
    }
  ]
}
```

## ğŸ“Š æ•ˆæœæŒ‡æ ‡

- **Bug å¤å‘ç‡**: è·Ÿè¸ªç›¸åŒç±»å‹ bug çš„å¤å‘æƒ…å†µ
- **é¢„é˜²æˆåŠŸç‡**: ç»Ÿè®¡ pre-release æ£€æŸ¥é˜»æ­¢çš„æ½œåœ¨é—®é¢˜
- **çŸ¥è¯†è¦†ç›–ç‡**: Postmortem è¦†ç›–çš„ä»£ç åŒºåŸŸæ¯”ä¾‹
